<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sheckle Market</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <style>
    .tab-content { display: none; animation: fade 0.5s ease-in-out; }
    .tab-active { display: block; }
    @keyframes fade { from {opacity: 0;} to {opacity: 1;} }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
  <!-- Navigation -->
  <nav class="bg-gray-800 p-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold">ü™ô Sheckle Market</h1>
    <div class="space-x-4">
      <button onclick="showTab('market')">Market</button>
      <button onclick="showTab('cart')">Cart</button>
      <button onclick="showTab('login')">Login</button>
      <button onclick="showTab('signup')">Signup</button>
    </div>
  </nav>

  <!-- Market -->
  <section id="market" class="tab-content tab-active p-6">
    <h2 class="text-xl mb-4">Buy Items</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
      <div class="bg-gray-700 p-4 rounded">
        <h3 class="text-lg">Golden Sheckle</h3>
        <p>$10</p>
        <button onclick="addToCart('Golden Sheckle', 10)" class="bg-yellow-500 px-3 py-1 mt-2 rounded hover:bg-yellow-400">Buy</button>
      </div>
      <div class="bg-gray-700 p-4 rounded">
        <h3 class="text-lg">Platinum Sheckle</h3>
        <p>$20</p>
        <button onclick="addToCart('Platinum Sheckle', 20)" class="bg-yellow-500 px-3 py-1 mt-2 rounded hover:bg-yellow-400">Buy</button>
      </div>
      <div class="bg-gray-700 p-4 rounded">
        <h3 class="text-lg">Diamond Sheckle</h3>
        <p>$50</p>
        <button onclick="addToCart('Diamond Sheckle', 50)" class="bg-yellow-500 px-3 py-1 mt-2 rounded hover:bg-yellow-400">Buy</button>
      </div>
    </div>
  </section>

  <!-- Cart -->
  <section id="cart" class="tab-content p-6">
    <h2 class="text-xl mb-4">üõí Your Cart</h2>
    <ul id="cartItems" class="mb-4"></ul>
    <p class="mb-2">Total: $<span id="cartTotal">0</span></p>
    <button onclick="checkout()" class="bg-green-500 px-4 py-2 rounded hover:bg-green-400">Checkout</button>
  </section>

  <!-- Login -->
  <section id="login" class="tab-content p-6">
    <h2 class="text-xl mb-4">Login</h2>
    <input id="loginUser" class="block w-full p-2 mb-2 bg-gray-800 rounded" placeholder="Username" />
    <input id="loginPass" type="password" class="block w-full p-2 mb-2 bg-gray-800 rounded" placeholder="Password" />
    <button onclick="login()" class="bg-blue-500 px-4 py-2 rounded hover:bg-blue-400">Login</button>
    <p id="loginMessage" class="mt-2 text-sm"></p>
  </section>

  <!-- Signup -->
  <section id="signup" class="tab-content p-6">
    <h2 class="text-xl mb-4">Signup</h2>
    <input id="signupUser" class="block w-full p-2 mb-2 bg-gray-800 rounded" placeholder="Username" />
    <input id="signupPass" type="password" class="block w-full p-2 mb-2 bg-gray-800 rounded" placeholder="Password" />
    <input id="signupGmail" class="block w-full p-2 mb-2 bg-gray-800 rounded" placeholder="Gmail (must be @gmail.com)" />
    <button onclick="sendEmailVerification()" class="bg-purple-500 px-4 py-2 rounded hover:bg-purple-400">Send Verification Code</button>
    <p id="signupMessage" class="mt-2 text-sm"></p>
  </section>

  <script>
    emailjs.init("c3M0Mn0DjoznjXaC8"); // ‚Üê Replace with your EmailJS public key

    let cart = [];

    function showTab(id) {
      document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("tab-active"));
      document.getElementById(id).classList.add("tab-active");
      if (id === "cart") updateCartUI();
    }

    function addToCart(item, price) {
      cart.push({ item, price });
      alert(`${item} added to cart!`);
    }

    function updateCartUI() {
      const cartList = document.getElementById("cartItems");
      const totalEl = document.getElementById("cartTotal");
      cartList.innerHTML = "";
      let total = 0;
      cart.forEach((product, i) => {
        total += product.price;
        cartList.innerHTML += `
          <li class="mb-2">
            ${product.item} - $${product.price}
            <button onclick="removeItem(${i})" class="ml-2 bg-red-500 px-2 rounded hover:bg-red-400">X</button>
          </li>
        `;
      });
      totalEl.textContent = total;
    }

    function removeItem(index) {
      cart.splice(index, 1);
      updateCartUI();
    }

    function checkout() {
      if (cart.length === 0) {
        alert("Cart is empty.");
        return;
      }
      alert("‚úÖ Order placed! Thank you!");
      cart = [];
      updateCartUI();
    }

    function login() {
      const u = document.getElementById("loginUser").value;
      const p = document.getElementById("loginPass").value;
      const saved = localStorage.getItem(u);
      const msg = document.getElementById("loginMessage");
      msg.className = "mt-2 text-sm";
      if (p === saved) {
        msg.textContent = "‚úÖ Logged in!";
        msg.classList.add("text-green-400");
      } else {
        msg.textContent = "‚ùå Wrong username or password.";
        msg.classList.add("text-red-400");
      }
    }

    function sendEmailVerification() {
      const user = document.getElementById("signupUser").value;
      const pass = document.getElementById("signupPass").value;
      const gmail = document.getElementById("signupGmail").value;
      const msg = document.getElementById("signupMessage");

      msg.className = "mt-2 text-sm";

      if (!gmail.endsWith("@gmail.com")) {
        msg.textContent = "‚ùå Please use a Gmail address.";
        msg.classList.add("text-red-400");
        return;
      }

      const code = Math.floor(100000 + Math.random() * 900000);
      localStorage.setItem("verify_code", code);
      localStorage.setItem("verify_user", JSON.stringify({ user, pass }));

      emailjs.send("gmail_service", "verification_template", {
        to_email: gmail,
        message: `Your Sheckle Market verification code is: ${code}`
      }).then(() => {
        const entered = prompt("Enter the code sent to your email:");
        if (entered == code) {
          const data = JSON.parse(localStorage.getItem("verify_user"));
          localStorage.setItem(data.user, data.pass);
          msg.textContent = "‚úÖ Signup complete!";
          msg.classList.add("text-green-400");
        } else {
          msg.textContent = "‚ùå Incorrect code.";
          msg.classList.add("text-red-400");
        }
      }).catch((err) => {
        console.error(err);
        msg.textContent = "‚ùå Failed to send verification email.";
        msg.classList.add("text-red-400");
      });
    }
  </script>
</body>
</html>
